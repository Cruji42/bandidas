<!doctype html>
<html>
    <head>
        <meta charset="utf-8">
        <meta http-equiv="x-ua-compatible" content="ie=edge">
        <title>Las Bandidas</title>
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">

        <!-- <link rel="manifest" href="site.webmanifest"> -->
        <link rel="shortcut icon" type="image/x-icon" href="img/favicon.png">
        <!-- Place favicon.ico in the root directory -->

        <!-- CSS here -->
        <link rel="stylesheet" href="css/bootstrap.min.css">
        <link rel="stylesheet" href="css/owl.carousel.min.css">
        <link rel="stylesheet" href="css/magnific-popup.css">
        <link rel="stylesheet" href="css/font-awesome.min.css">
        <link rel="stylesheet" href="css/themify-icons.css">
        <link rel="stylesheet" href="css/nice-select.css">
        <link rel="stylesheet" href="css/flaticon.css">
        <link rel="stylesheet" href="css/animate.css">
        <link rel="stylesheet" href="css/slicknav.css">
        <link rel="stylesheet" href="css/style.css">
        <!-- <link rel="stylesheet" href="css/responsive.css"> -->
    </head>

    <body>
        <div class="login_content d-flex align-items-center justify-content-center">
                    <div class="card w-50 card-login ">
                        <div class="card-header border-0 ">
                            <div class="d-flex align-items-center justify-content-center">
                                <img class="logo-login" src="img/logo.png" alt="">
                            </div>
                            <br>
                            <div class="d-flex align-items-center justify-content-center">
                                <h3 class="text-white">REGISTRO</h2>
                            </div>
                        </div>
                        <div class="card-body card-register">
                            <div class="d-flex align-items-center justify-content-center mb-3">
                                <div class="input-group-prepend">
                                    <span class="input-group-text">
                                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-person-fill" viewBox="0 0 16 16">
                                            <path d="M3 14s-1 0-1-1 1-4 6-4 6 3 6 4-1 1-1 1H3zm5-6a3 3 0 1 0 0-6 3 3 0 0 0 0 6z"/>
                                          </svg>
                                    </span>
                                </div>
                                <input class="input-login rounded-right" id="name" name="name" type="text" placeholder="Nombre">
                            </div>
                            <div class="d-flex align-items-center justify-content-center mb-3">
                                <div class="input-group-prepend rounded-right">
                                    <span class="input-group-text">
                                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-person-fill" viewBox="0 0 16 16">
                                            <path d="M3 14s-1 0-1-1 1-4 6-4 6 3 6 4-1 1-1 1H3zm5-6a3 3 0 1 0 0-6 3 3 0 0 0 0 6z"/>
                                          </svg>
                                    </span>
                                </div>
                                <input class="input-login rounded-right" id="lastName" name="lastName" type="text" placeholder="Apellidos">
                            </div>
                            <div class="d-flex align-items-center justify-content-center mb-3">
                                <div class="input-group-prepend">
                                    <span class="input-group-text">
                                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-person-fill" viewBox="0 0 16 16">
                                            <path d="M3 14s-1 0-1-1 1-4 6-4 6 3 6 4-1 1-1 1H3zm5-6a3 3 0 1 0 0-6 3 3 0 0 0 0 6z"/>
                                          </svg>
                                    </span>
                                </div>
                                <input class="input-login rounded-right" id="phone" name="phone" type="text" placeholder="Telefono">
                            </div>
                            <div class="d-flex align-items-center justify-content-center mb-3">
                                <div class="input-group-prepend">
                                    <span class="input-group-text">
                                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-envelope-fill" viewBox="0 0 16 16">
                                            <path d="M.05 3.555A2 2 0 0 1 2 2h12a2 2 0 0 1 1.95 1.555L8 8.414.05 3.555ZM0 4.697v7.104l5.803-3.558L0 4.697ZM6.761 8.83l-6.57 4.027A2 2 0 0 0 2 14h12a2 2 0 0 0 1.808-1.144l-6.57-4.027L8 9.586l-1.239-.757Zm3.436-.586L16 11.801V4.697l-5.803 3.546Z"/>
                                          </svg>
                                    </span>
                                </div>
                                <input class="input-login rounded-right" id="email" name="email" type="email" placeholder="Email">
                            </div>
                            <div class="d-flex align-items-center justify-content-center mb-3">
                                <div class="input-group-prepend rounded-right">
                                    <span class="input-group-text">
                                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-key-fill" viewBox="0 0 16 16">
                                            <path d="M3.5 11.5a3.5 3.5 0 1 1 3.163-5H14L15.5 8 14 9.5l-1-1-1 1-1-1-1 1-1-1-1 1H6.663a3.5 3.5 0 0 1-3.163 2zM2.5 9a1 1 0 1 0 0-2 1 1 0 0 0 0 2z"/>
                                        </svg> 
                                    </span>
                                </div>
                                <input class="input-login rounded-right" id="pass" name="pass" type="password" placeholder="Contraseña">
                            </div>
                            <div class="d-flex align-items-center justify-content-center mb-3">
                                <div class="input-group-prepend rounded-right">
                                    <span class="input-group-text">
                                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-key-fill" viewBox="0 0 16 16">
                                            <path d="M3.5 11.5a3.5 3.5 0 1 1 3.163-5H14L15.5 8 14 9.5l-1-1-1 1-1-1-1 1-1-1-1 1H6.663a3.5 3.5 0 0 1-3.163 2zM2.5 9a1 1 0 1 0 0-2 1 1 0 0 0 0 2z"/>
                                        </svg> 
                                    </span>
                                </div>
                                <input class="input-login rounded-right" id="pass-confirm" name="pass-confirm" type="password" placeholder="Confirmacion de contraseña">
                            </div>
                            <div class="d-flex align-items-center justify-content-center mb-3">
                                <div class="input-group-prepend">
                                    <span class="input-group-text">
                                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-person-fill" viewBox="0 0 16 16">
                                            <path d="M3 14s-1 0-1-1 1-4 6-4 6 3 6 4-1 1-1 1H3zm5-6a3 3 0 1 0 0-6 3 3 0 0 0 0 6z"/>
                                          </svg>
                                    </span>
                                </div>
                                <input class="input-login rounded-right" id="address" name="address" type="text" placeholder="Dirección">
                            </div>
                            <div class="d-flex align-items-center justify-content-center mb-3">
                                <div class="input-group-prepend rounded-right">
                                    <span class="input-group-text">
                                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-person-fill" viewBox="0 0 16 16">
                                            <path d="M3 14s-1 0-1-1 1-4 6-4 6 3 6 4-1 1-1 1H3zm5-6a3 3 0 1 0 0-6 3 3 0 0 0 0 6z"/>
                                          </svg>
                                    </span>
                                </div>
                                <input class="input-login rounded-right" id="city" name="city" type="text" placeholder="Ciudad">
                            </div>
                        </div>
                        <div class="card-food ">
                            <div class="d-flex align-items-center justify-content-center  mt-5">
                                <button class="btn pl-5 pr-5 ml-5 mr-5 btn-outline-warning button-login" onclick="register()" >Entrar</button>
                            </div>
                            <div class="d-flex align-item-center justify-content-center mt-2 mb-2">
                                <span class="register-link">¿Ya tienes cuenta? <a href="./login.html">Inicia sesión aquí</a></span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    

    </body>
    <script src="./ajax-jquery.min.js"></script>
    <script src="//cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <script>
        function register () {
            var pass = document.getElementById("pass").value;
            var pass_Confirmation = document.getElementById("pass-confirm").value;
            var name = document.getElementById("name").value;
            var last_Name =  document.getElementById("lastName").value;
            var email =  document.getElementById("email").value;
            var address =  document.getElementById("address").value;
            var city = document.getElementById("city").value;
            var phone = parseInt(document.getElementById("phone").value);
        


            if(pass===pass_Confirmation){
                //console.log("son iguales")
                $.ajax({
                type: "POST",
                url: "https://bandidas.herokuapp.com/index.php/USER",
                data: JSON.stringify({ 
                    "Name": name, 
                    "LastName": last_Name, 
                    "Telephone": phone, 
                    "Address": address,  
                    "City": city,
                    "Mail" : email, 
                    "Password": pass}),
                contentType: "application/json",
                success: function (result, status) {
                            if(result.body === "success"){
                                Swal.fire({
                                title: 'Cuenta creada',
                                text: 'Tu cuenta en Las Bandidas ha sido creada satisfactoriamente',
                                icon: 'success',
                                confirmButtonText: 'Aceptar',
                                confirmButtonColor: '#F2C64D'
                                }).then((res) => {
                                    if(res.isConfirmed){
                                        login(email,pass);
                                    }
                                } )

                            }else if (result === "DB query Error"){
                                Swal.fire({
                                title: 'Correo duplicado',
                                text: 'Ya existe cuenta con este correo',
                                icon: 'error',
                                confirmButtonText: 'Aceptar',
                                confirmButtonColor: '#F2C64D'
                                }) 
                            }else if(JSON.parse( result.body).error !== null || JSON.parse( result.body).error !== undefined){
                                Swal.fire({
                                    title: 'Campo vacío',
                                    text: 'favor de llenar todos los campos',
                                    icon: 'warning',
                                    confirmButtonText: 'Aceptar',
                                    confirmButtonColor: '#F2C64D'
                                })
                            }
                         },
                error: function (error, status) {
                            console.log(error);
                        }
                })
            } else{
                Swal.fire({
                     title: 'Contraseñas no coinciden',
                     text: 'favor de verificar contraseñas',
                     icon: 'warning',
                     confirmButtonText: 'Aceptar',
                     confirmButtonColor: '#F2C64D'
                })
            }
        }

        function login (email,pass) {
            $.ajax({
                type: "POST",
                url: "https://bandidas.herokuapp.com/Login.php",
                data: JSON.stringify({ "Mail": email, "Password" : pass}),
                contentType: "application/json",
                success: function (result, status) {
                            console.log(result);
                            location.href = './index.html';
                         },
                error: function (error, status) {
                            console.log(error);
                        }
            })
        }
       
    </script>
</html>